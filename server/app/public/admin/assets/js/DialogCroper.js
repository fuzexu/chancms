import{a as e,B as l,C as t,f as o,q as a,J as i}from"./element-plus.js";import{M as s}from"./vue-cropper.js";import{ad as r,o as n,R as m,Q as d,a as p,M as c,U as u,_ as f,$ as h,T as g,ay as C,az as b}from"./@vue.js";import{_}from"./index.js";const w={name:"DialogCropper",components:{VueCropper:s},props:{file:{type:Object,default:null},img:{type:String,default:""}},data(){return{dialogFormVisible:!1,width:"100%",height:"350px",model:!1,modelSrc:"",crap:!1,previews:{},option:{img:this.img,size:.7,full:!1,outputType:"png",centerBox:!0,max:99999},show:!0,fixed:!1,fixedNumber:[75,34]}},watch:{img:{handler(e){this.option.img=e},immediate:!0}},mounted:function(){},methods:{changeScale(e){e=e||1,this.$refs.cropper.changeScale(e)},rotateLeft(){this.$refs.cropper.rotateLeft()},rotateRight(){this.$refs.cropper.rotateRight()},realTime(e){this.previews=e,console.log(e)},uploadImg(e){let l=e.file;if(-1===l.type.indexOf("image"))return this.$message("上传文件只能是图片格式"),!1;const t=new FileReader;t.onload=async e=>{let l;l="object"==typeof e.target.result?window.URL.createObjectURL(new Blob([e.target.result])):e.target.result,this.option.img=l,this.dialogFormVisible=!0},t.readAsArrayBuffer(l)},imgLoad(e){console.log(e)},cropMoving(e){console.log(e,"截图框当前坐标")},handlerCancel(){this.$emit("crop"),this.dialogFormVisible=!1},handlerOk(){this.$refs.cropper.getCropBlob((e=>{let l=new File([e],this.file.name,{type:this.file.type});this.$emit("crop",l),this.dialogFormVisible=!1}))}}},V=e=>(C("data-v-6726b25b"),e=e(),b(),e),k={class:"model-show"},v=["src"],y={class:"flex items-start scroper-aside pt-6"},R={class:"flex items-center mb-6 pr-10"},x=V((()=>p("span",{class:"ml-3 mr-3"},"W",-1))),L={class:"flex items-center pr-10"},F=V((()=>p("span",{class:"ml-3 mr-3"},"H",-1))),$={class:"dialog-footer"};const j=_(w,[["render",function(s,C,b,_,w,V){const j=r("VueCropper"),S=r("Upload"),T=e,U=l,M=t,z=o,B=r("Plus"),I=r("Minus"),O=r("Refresh"),q=r("RefreshLeft"),P=r("RefreshRight"),A=r("Close"),D=a,H=i;return n(),m(H,{modelValue:w.dialogFormVisible,"onUpdate:modelValue":C[6]||(C[6]=e=>w.dialogFormVisible=e),title:"图片裁剪",width:"50%"},{footer:d((()=>[p("span",$,[c(z,{class:"mr-6",onClick:V.handlerCancel},{default:d((()=>[u("取消")])),_:1},8,["onClick"]),c(z,{type:"primary",onClick:V.handlerOk},{default:d((()=>[u("确定")])),_:1},8,["onClick"])])])),default:d((()=>[f(p("div",{class:"model",onClick:C[0]||(C[0]=e=>w.model=!1)},[p("div",k,[p("img",{src:w.modelSrc,alt:""},null,8,v)])],512),[[h,w.model]]),p("div",{class:"cut pos-r",style:g({width:w.width,height:w.height})},[c(j,{ref:"cropper",img:w.option.img,"output-size":w.option.size,"output-type":w.option.outputType,full:w.option.full,"auto-crop":!0,"auto-crop-width":120,"auto-crop-height":120,onRealTime:V.realTime,onImgLoad:V.imgLoad,mode:"contain",onCropMoving:V.cropMoving},null,8,["img","output-size","output-type","full","onRealTime","onImgLoad","onCropMoving"]),p("div",y,[c(z,{class:"ml-6 mb-4"},{default:d((()=>[c(M,{"http-request":V.uploadImg,"show-file-list":!1},{default:d((()=>[c(U,{placement:"top-start",title:"上传"},{reference:d((()=>[c(T,null,{default:d((()=>[c(S)])),_:1})])),_:1})])),_:1},8,["http-request"])])),_:1}),c(z,{class:"ml-6 mb-4",onClick:C[1]||(C[1]=e=>V.changeScale(1))},{default:d((()=>[c(T,null,{default:d((()=>[c(B)])),_:1})])),_:1}),c(z,{class:"ml-6 mb-4",onClick:C[2]||(C[2]=e=>V.changeScale(-1))},{default:d((()=>[c(T,null,{default:d((()=>[c(I)])),_:1})])),_:1}),c(z,{class:"ml-6 mb-4",onClick:s.refreshCrop},{default:d((()=>[c(T,null,{default:d((()=>[c(O)])),_:1})])),_:1},8,["onClick"]),c(z,{class:"ml-6 mb-4",onClick:V.rotateLeft},{default:d((()=>[c(T,null,{default:d((()=>[c(q)])),_:1})])),_:1},8,["onClick"]),c(z,{class:"ml-6 mb-4",onClick:V.rotateRight},{default:d((()=>[c(T,null,{default:d((()=>[c(P)])),_:1})])),_:1},8,["onClick"]),c(z,{class:"ml-6 mb-4",onClick:C[3]||(C[3]=()=>w.option.img="")},{default:d((()=>[c(T,null,{default:d((()=>[c(A)])),_:1})])),_:1}),p("div",R,[c(D,{class:"ml-6 w-full",modelValue:w.width,"onUpdate:modelValue":C[4]||(C[4]=e=>w.width=e),placeholder:"Please input"},null,8,["modelValue"]),x]),p("div",L,[c(D,{class:"ml-6 w-full",modelValue:w.height,"onUpdate:modelValue":C[5]||(C[5]=e=>w.height=e),placeholder:"Please input"},null,8,["modelValue"]),F])])],4)])),_:1},8,["modelValue"])}],["__scopeId","data-v-6726b25b"]]);export{j as _};
